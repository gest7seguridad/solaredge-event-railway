# ConfiguraciÃ³n de Nixpacks para Railway
# https://nixpacks.com/docs/configuration/file

# Proveedor y versiÃ³n de Node.js
[phases.setup]
nixPkgs = ["nodejs-18_x"]

# Instalar dependencias y compilar en un solo paso
[phases.build]
cmds = [
  "echo 'ðŸ“¦ Installing backend dependencies...'",
  "cd backend && npm install --production=false",
  "echo 'ðŸ”¨ Building backend...'",
  "npm run build",
  "echo 'ðŸ“¦ Installing frontend dependencies...'",
  "cd ../frontend && npm install --production=false",
  "echo 'ðŸŽ¨ Building frontend...'",
  "npm run build",
  "echo 'âœ… Build completed!'"
]

# Variables de entorno necesarias para el build
[variables]
NODE_ENV = "production"
NPM_CONFIG_PRODUCTION = "false"

# Comando de inicio
[start]
cmd = "node backend/dist/server.js"